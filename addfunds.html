<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Add Funds</title>
   <style>
      /* Add Funds Page Styles (same as before) */
      * {
         margin: 0;
         padding: 0;
         box-sizing: border-box;
         font-family: Arial, sans-serif;
      }

      body {
         display: flex;
         flex-direction: column;
         min-height: 100vh;
         background: #1c1e29;
         color: #ffffff;
      }

      .navbar {
         display: flex;
         justify-content: space-between;
         align-items: center;
         background-color: #292d3e;
         padding: 15px 30px;
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
         margin-top: 10px;
      }

      .logo-container {
         text-align: center;
         margin-top: 30px;
      }

      .logo {
         color: #ffffff;
         font-size: 1.5rem;
         font-weight: bold;
      }

      .menu {
         display: flex;
         gap: 20px;
      }

      .menu a {
         color: #ffffff;
         text-decoration: none;
         font-size: 1rem;
         padding: 10px;
         border-radius: 5px;
         transition: background 0.3s;
      }

      .menu a:hover {
         background-color: #1a75ff;
      }

      .add-funds-container {
         background: #292d3e;
         border-radius: 8px;
         box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
         width: 400px;
         padding: 20px;
         margin-top: 20px;
         text-align: center;
      }

      .add-funds-container h2 {
         color: #00aaff;
         margin-bottom: 20px;
         font-weight: 600;
      }

      input, select, button {
         width: 100%;
         padding: 10px;
         margin-bottom: 10px;
         border-radius: 5px;
         border: 1px solid #ccc;
      }

      button {
         background-color: #28a745;
         color: #fff;
         border: none;
         cursor: pointer;
         transition: background 0.3s;
      }

      button:hover {
         background-color: #218838;
      }

      #sendMoneyInfo {
         display: none;
         margin-top: 20px;
      }

      .copy-button {
         background-color: #1a75ff;
         color: #fff;
         border: none;
         padding: 5px 10px;
         cursor: pointer;
         border-radius: 5px;
         transition: background 0.3s;
      }

      .copy-button:hover {
         background-color: #1565c0;
      }

      #successMessage {
         display: none;
         color: green;
         margin-top: 10px;
      }

      #confirmTransaction {
         background-color: #ff9900;
      }

      #confirmTransaction:hover {
         background-color: #e68900;
      }
   </style>
</head>
<body>
   <div class="logo-container">
      <div class="logo">Aura E-sports</div>
   </div>

   <!-- Navigation Bar -->
   <div class="navbar">
      <a href="dashboard.html" id="dashboardLink">Dashboard</a>
      <a href="tournament.html">Tournament</a>
      <a href="withdraw.html">Withdraw</a>
      <a href="helpcentre.html">Help Centre</a>
   </div>

   <!-- Add Funds Form -->
   <div class="add-funds-container">
      <h2>Add Funds</h2>
      <form id="addFundsForm">
         <input type="number" id="amountInput" placeholder="Enter Amount (min 20৳)" min="20" required>
         <select id="paymentMethod" required>
            <option value="">Select Payment Method</option>
            <option value="bKash">bKash</option>
            <option value="Nagad">Nagad</option>
            <option value="Rocket">Rocket</option>
         </select>
         <button type="button" id="payNowButton">Pay Now</button>
      </form>

      <!-- Send Money Info -->
      <div id="sendMoneyInfo">
         <p>Send Money: <span id="paymentNumber">01798502666</span></p>
         <button class="copy-button" id="copyButton">Copy</button>
         <p id="successMessage">Copied successfully!</p>

         <!-- Transaction ID Input -->
         <input type="text" id="transactionId" placeholder="Transaction ID / Sender Wallet Number" required>
         <button type="button" id="confirmTransaction">Confirm</button>
      </div>
   </div>

   <!-- Firebase SDKs -->
   <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
   <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
   <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>

   <script>
      // Firebase configuration
      const firebaseConfig = {
         apiKey: "AIzaSyDr6dc3a-LUQwvtvnrb006fjhhaXlZTT1k",
         authDomain: "sphere-tournament.firebaseapp.com",
         projectId: "sphere-tournament",
         storageBucket: "sphere-tournament.firebasestorage.app",
         messagingSenderId: "49933225091",
         appId: "1:49933225091:web:b1f3fe657491c94b2f9fb6",
         measurementId: "G-EPKCPTL47V"
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();

      // Show the Send Money info and hide the form
      document.getElementById("payNowButton").onclick = function() {
         const amount = parseFloat(document.getElementById("amountInput").value);
         const paymentMethod = document.getElementById("paymentMethod").value;

         if (amount >= 20 && paymentMethod) {
            document.getElementById("addFundsForm").style.display = "none";
            document.getElementById("sendMoneyInfo").style.display = "block";
         } else {
            alert("Please enter a valid amount (min 20৳) and select a payment method.");
         }
      };

      // Copy payment number to clipboard
      document.getElementById("copyButton").onclick = function() {
         const paymentNumber = document.getElementById("paymentNumber").innerText;
         navigator.clipboard.writeText(paymentNumber)
            .then(() => {
               document.getElementById("successMessage").style.display = "block";
               setTimeout(() => document.getElementById("successMessage").style.display = "none", 3000);
            })
            .catch(err => console.error("Error copying to clipboard: ", err));
      };

      // Confirm the transaction and send details to Telegram
      document.getElementById("confirmTransaction").onclick = function() {
         const transactionId = document.getElementById("transactionId").value;
         const email = auth.currentUser.email;
         const amount = document.getElementById("amountInput").value;
         const paymentMethod = document.getElementById("paymentMethod").value;

         if (transactionId) {
            const message = `User Email: ${email}\nAmount: ৳${amount}\nPayment Method: ${paymentMethod}\nTransaction ID / Wallet: ${transactionId}`;

            // Send message to Telegram
            const botToken = "7902145261:AAHY6gBHmMN_ubLJbnEpJCtnCd0HvUB71M0";
            const chatId = "7174617845";
            const telegramUrl = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`;

            fetch(telegramUrl)
               .then(response => response.json())
               .then(data => {
                  if (data.ok) {
                     alert("Transaction confirmed and details sent to admin.");
                  } else {
                     alert("Failed to send message to Telegram.");
                  }
               })
               .catch(error => console.error("Error sending message to Telegram:", error));
         } else {
            alert("Please enter the Transaction ID / Wallet Number.");
         }
      };
   </script>
</body>
</html>
